<!--
{
  "title": "Ardour",
  "date": "2017-07-20T21:01:12+09:00",
  "category": "",
  "tags": [],
  "draft": true
}
-->

# TODO

- jack audio/midi, in/out
  - track, bus setup
- playback, recording
- plugin host (lua, lv2)
- mixer view
- editor view
- ardour file format
- build system
- threading


# Overview

```
[ Data structure ]

ARDOUR_UI

ARDOUR::Session

AudioEngine
'-' JACKAudioBackend (< AudioBackend)
  '-'

EventLoop
'-* RequestBufferSupplier

BufferManager
'- ThreadBuffer..


[ Procedure ]

(Main)
- main =>
  - ARDOUR::init =>
    - SessionEvent::init_event_pool => new PerThreadPool
    - XXX::make_property_quarks (e.g. AudioRegion::make_property_quarks)
    - SourceFactory::init =>
      - Thread::create(.. peak_thread_work) x 2 (TODO: who are these ?)
    - PluginManager::instance => new PluginManager
    - ControlProtocolManager::instance => new ControlProtocolManager
      (usually no ControlProtocol unless you have dedicated hardware ??)
    - EventLoop::register_request_buffer_factory("midiUI", MidiControlUI::request_factory) =>
      - EventLoop::request_buffer_suppliers.push_back .. (TODO: when is it used ?)
    - BufferManager::init =>
      - new ThreadBufferFIFO, ThreadBufferList, ThreadBuffers
    - ARDOUR::AudioEngine::create => new AudioEngine =>
      - discover_backends => load ARDOUR::AudioBackendInfo from "libjack_audiobackend.so" (jack_api.cc)
  - new ARDOUR_UI =>
    - .. connect signal and callback ..
    - SessionEvent::create_per_thread_pool ("GUI", 4096) => ??
    - new ArdourKeyboard
    - ActionManager::init => Gtk::UIManager::create
    - WM::Manager::register_window (e.g. midi_port_matrix) => ..
    - new ProcessThread
    - attach_to_engine => AudioEngine::Running.connect(.. ARDOUR_UI::engine_running ..)
  - ARDOUR_UI::run (i.e. Gtkmm2ext::UI::run) => Gtk::Main::run


(UI event handling)
- ?? follow record or playback button callback


(Audio thread)
- ??
```


# Reference

- Ardour
  - http://manual.ardour.org/toc/
  - https://ardour.org/development.html
- Jack
  - [./2017-07-19-jack.html](./2017-07-19-jack.html)
- LV2 plugin
  - http://lv2plug.in/ns/
  - https://github.com/pantherb/setBfree
  - https://github.com/calf-studio-gear/calf
- Soundfont
  - http://www.fluidsynth.org/
